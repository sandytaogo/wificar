C51 COMPILER V7.06   MAIN                                                                  05/27/2024 10:00:12 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: H:\keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          /**
   2          * Copyright (C) wificar, Inc.
   3          * 主驱动控制程序，包含数字信号，模拟信号之间转换 波特率之间解陆饴虢饴
   4          * @author txf
   5          * @date 2020-04-12 12:12:12
   6          */
   7          #include<reg52.h> //包含头文件，一般情况不需要改动，头文件包含特殊功能寄存器的定义
   8          #include "util.h"
   9          sbit Trig  = P3^4; //雷达产生脉冲引脚
  10          sbit Echo  = P3^5; //接收雷达回波引脚
  11          sbit p1 = P1^0;
  12          sbit p2 = P1^1;
  13          uint switch_action = -1;
  14          /*****************声明函数开始***************/
  15          
  16          void init_com_port ( void );
  17          void drive_execute(uchar temp);
  18          /*****************声明函数结束***************/
  19          //*****************程序入口***************************************
  20          
  21          void init_com_port ( void ) {
  22   1              SCON = 0x50;    /*SCON:work mode 1,8-bit UART E:receive */
  23   1          TMOD |= 0x20;       /*TMOD time 1,mode 2 , 8-bit reload*/
  24   1         // PCON = 0x00;
  25   1              TH1 = 0xFd;    /*TH1: reload value for 9600 baud @ 11.0592MHZ 波特率*/
  26   1              //TL1 = 0xFd;
  27   1              TR1 = 1;                /*TR1 time 1 run*/
  28   1              EA = 1;  /*open Headquarters suspend*/
  29   1              ES = 1;  /*open com port suspend*/      
  30   1              //IT0=0;
  31   1              //EX0=1; 
  32   1      }
  33          
  34          /*********************外部中断0初始化**********************/
  35          void ex_init( void ) {
  36   1              IT0 = 1;//指定外部中断0下降沿触发，INT0 (P3.2
  37   1              EX0 = 1;//使能外部中断
  38   1              EA = 1; //开总中断
  39   1      }
  40          
  41          /********************定时器0初始化*************/
  42          void tim_init( void ) {
  43   1              TMOD = 0X02;//定时器0工作方式2，TH0是重装值，TL0是初值
  44   1              TH0=0x00; //重载值
  45   1              TL0=0x00; //初始化值
  46   1              ET0=1;    //开中断
  47   1              TR0=1; 
  48   1      }
  49          
  50          // 串口中断程序
  51          void com_port ( void ) interrupt 4 {
  52   1              unsigned char temp;
  53   1              if(RI) {
  54   2                      RI = 0;/*RI: flag reset*/
  55   2                      temp = SBUF; /*receive value*/
C51 COMPILER V7.06   MAIN                                                                  05/27/2024 10:00:12 PAGE 2   

  56   2                      drive_execute(temp); 
  57   2              }
  58   1      }
  59          
  60          void main ( void ) {
  61   1              uint index = 0;
  62   1              init_com_port();
  63   1              while (1) {
  64   2                      if(0 == switch_action){
  65   3                              p1 = 0;
  66   3                              delay(18);
  67   3                              p1 = 1; 
  68   3                              delay(2);
  69   3                      }else if(1 == switch_action){
  70   3                              p1 = 0;
  71   3                              delay(19);
  72   3                              p1 = 1; 
  73   3                              delay(1);
  74   3                      }else if(2 == switch_action){
  75   3                              p2 = 0;
  76   3                              delay(18);
  77   3                              p2 = 1; 
  78   3                              delay(2);
  79   3                      }else if(3 == switch_action){
  80   3                              p2 = 0;
  81   3                              delay(18.5);
  82   3                              p2 = 1; 
  83   3                              delay(1.5);
  84   3                      }
  85   2                      if(-1 != switch_action){
  86   3                              index++;
  87   3                      }
  88   2                      if(300<index) {
  89   3                              switch_action = -1;
  90   3                              index = 0 ;
  91   3                      }
  92   2                      p1 = 0;
  93   2                      p2 = 0;
  94   2              }               
  95   1      }
  96          
  97          void drive_execute (uint direction) {
*** WARNING C235 IN LINE 97 OF MAIN.C: parameter 1: different types
  98   1              P0 = direction;
  99   1              switch(direction){
 100   2                      case 'a':
 101   2                              P2 = 0X96;
 102   2                              delay(1000);
 103   2                              P2 = 0X00;
 104   2                      break;
 105   2                      case 'c':
 106   2                              P2 = 0X90;
 107   2                              delay(1000);
 108   2                              P2 = 0X00;
 109   2                      break;
 110   2                      case 'd':
 111   2                              P2 = 0X06;
 112   2                              delay(1000);
 113   2                              P2 = 0X00;
 114   2                      break;
 115   2                      case 'b':
 116   2                              P2 = 0X69;
C51 COMPILER V7.06   MAIN                                                                  05/27/2024 10:00:12 PAGE 3   

 117   2                              delay(1000);
 118   2                              P2 = 0X00;
 119   2                      break;
 120   2                      case 'e':
 121   2                              switch_action = 2;
 122   2                              delay(10);
 123   2                      break;
 124   2                      case '2':
 125   2                              switch_action = 3;
 126   2                              delay(10);
 127   2                      break;
 128   2                      case '1':
 129   2                              switch_action = 0;
 130   2                              delay(10);
 131   2                      break;
 132   2                      case '3':
 133   2                              switch_action = 1;
 134   2                              delay(10);
 135   2                      break;
 136   2              }
 137   1              P0 = 0XFF;
 138   1      }
 139          
 140          
 141          
 142          
 143          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    348    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
